{% extends 'shop_update/base.html' %}
{% load static %}


{% block content %}
           <!-- Products -->
<div id="app">
    
            <div v-if="!showCryptoView && !showTradeView && !showOrderView && !showProductDetailView && !showTermsView">
                <!-- Bill board-->
                <div class="billboard">
                    <div class="billboard-slider" id="billboard-slider">
                        
                        {% if  billboard_images.image1 %}
                            <div class="billboard-slide">
                                <img src="{{ billboard_images.image1 }}" alt="Welcome to Digital Products Shop" class="billboard-bg">        
                            
                            {% else %}
                            <div class="billboard-slide" style="background: linear-gradient(rgba(45, 123, 215, 0.8), rgba(45, 123, 215, 0.9));">
                            <div class="billboard-content">
                                <h1>Welcome to Digital Products Shop</h1>
                                <p>Get the best digital products and services</p>
                            </div>
                            {% endif %}
                        
                        
                        </div>

                            {% if  billboard_images.image2 %}
                            <div class="billboard-slide">
                                <img src="{{ billboard_images.image2 }}" alt="Welcome to Digital Products Shop" class="billboard-bg">        
                           
                            {% else %}
                            <div class="billboard-slide" style="background: linear-gradient(rgba(45, 123, 215, 0.8), rgba(45, 123, 215, 0.9));">
                            <div class="billboard-content">
                                <h1>Special Offers</h1>
                                <p>Save big on gaming credits and gift cards</p>
                            </div>
                            {% endif %}
                        
                        </div>

                        {% if  billboard_images.image3 %}
                            <div class="billboard-slide">
                                <img src="{{ billboard_images.image3 }}" alt="Welcome to Digital Products Shop" class="billboard-bg">        
                          
                            {% else %}
                            <div class="billboard-slide" style="background: linear-gradient(rgba(45, 123, 215, 0.8), rgba(45, 123, 215, 0.9));">
                            <div class="billboard-content">
                                <h1>New eSIM Products</h1>
                                <p>Travel the world, stay connected</p>
                            </div>
                            {% endif %}
                        
                        </div>

                    </div>
                    </div>
                    <script>
                    document.addEventListener('DOMContentLoaded', () => {
                    const slider = document.getElementById('billboard-slider');
                    const slides = slider.querySelectorAll('.billboard-slide');
                    const totalSlides = slides.length;
                    let currentSlide = 0;

                    setInterval(() => {
                        currentSlide = (currentSlide + 1) % totalSlides;
                        const offset = -currentSlide * 100;
                        slider.style.transform = `translateX(${offset}%)`;
                    }, 4000); // 4 seconds
                    });
                    </script>
                            <style>
            .referral-close {
  position: absolute;
  top: 15px;
  left: 15px;
  background: none;
  border: none;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  color: #333;
  transition: all 0.3s ease;
}

.referral-close:hover {
  background: rgba(0, 0, 0, 0.05);
  transform: rotate(90deg);
}

                        </style>


                <div class="categories">
                    <a hx-boost="false" href="{% url 'finance' %}">
                        <button class="referral-close">
                            <i class="fas fa-arrow-left"></i>
                        </button>
                    </a>
                        <!-- Categories -->
                    <div class="category"
                        style="box-shadow: 0 2px 8px rgba(45, 123, 215, 0.1); border: 1px solid #e6f0ff;">
                        <h2>Games</h2>
                        <div class="products">
                            <div class="product-slider games-slider" data-category="games">
                                <!-- Producs -->
                                {% for product in game_products %}
                                <a href="{% url 'product-detail' product.slug %}" class="product">
                                    <div class="discount-badge" style="background: #2D7BD7;">-{{ product.discount }}%
                                    </div>
                                    <div class="product-icon">
                                        {% if product.image %}
                                        <img src="{{ product.image }}" alt="{{ product.name }}">
                                        {% else %}
                                        <img src="/static/images/placeholder.png" alt="No image available">
                                        {% endif %}
                                    </div>
                                    <span>{{ product.name }}</span>
                                </a>
                                {% endfor %}
                            </div>
                        </div>
                    </div>

                    <!--Ecommerce-->
                    <div class="category" style="box-shadow: 0 2px 8px rgba(45, 123, 215, 0.1); border: 1px solid #e6f0ff;">
                        <h2>Ecommerce</h2>
                        <div class="products">
                            <div class="product-slider ecommerce-slider" data-category="ecommerce">
                                <!-- Producs -->
                                {% for product in ecommerce_products %}
                                <a href="{% url 'product-detail' product.slug %}" class="product">
                                    <div class="discount-badge" style="background: #2D7BD7;">-{{ product.discount }}%</div>
                                    <div class="product-icon">
                                        {% if product.image %}
                                        <img src="{{ product.image }}" alt="{{ product.name }}">
                                        {% else %}
                                        <img src="/static/images/placeholder.png" alt="No image available">
                                        {% endif %}
                                    </div>
                                    <span>{{ product.name }}</span>
                                </a>
                                {% endfor %}
                            </div>
                        </div>
                    </div>

                    <!--Esim-->
                    <div class="category" 
                        style="box-shadow: 0 2px 8px rgba(45, 123, 215, 0.1); border: 1px solid #e6f0ff;">
                        <h2>eSIM Products</h2>
                        <div class="products">
                            <div class="product-slider esim-slider" data-category="esim">
                                <!-- Producs -->
                                {% for product in esim_products %}
                                <a href="{% url 'product-detail' product.slug %}" class="product">
                                    <div class="discount-badge" style="background: #2D7BD7;">-{{ product.discount }}%
                                    </div>
                                    <div class="product-icon">
                                        {% if product.image %}
                                        <img src="{{ product.image }}" alt="{{ product.name }}">
                                        {% else %}
                                        <img src="/static/images/placeholder.png" alt="No image available">
                                        {% endif %}
                                    </div>
                                    <span>{{ product.name }}</span>
                                </a>
                                {% endfor %}
                            </div>
                        </div>
                    </div>

                    <!--Gift Cards-->
                    <!-- <div class="category" style="box-shadow: 0 2px 8px rgba(45, 123, 215, 0.1); border: 1px solid #e6f0ff;">
                        <h2>Gift Cards</h2>
                        <div class="products">
                            <div class="product-slider giftcard-slider" data-category="giftcard">
                                Products 
                                {% for product in giftcard_products %}
                                <a href="{% url 'product-detail' product.slug %}" class="product">
                                    <div class="discount-badge" style="background: #2D7BD7;">-{{ product.discount }}%</div>
                                    <div class="product-icon">
                                        {% if product.image %}
                                        <img src="{{ product.image }}" alt="{{ product.name }}">
                                        {% else %}
                                        <img src="/static/images/placeholder.png" alt="No image available">
                                        {% endif %}
                                    </div>
                                    <span>{{ product.name }}</span>
                                </a>
                                {% endfor %}
                            </div>
                        </div>
                    </div> -->
                </div>
                <!-- Buttom nav -->
                <nav class="bottom-nav" id="bottom-nav">
                    <a style="text-decoration: none;" href="{% url 'shop_update' %}" class="nav-item active" data-tab="shop">
                        <svg viewBox="0 0 24 24">
                            <path fill="currentColor"
                                d="M12,3L2,12H5V20H19V12H22L12,3M12,8.75A2.25,2.25 0 0,1 14.25,11A2.25,2.25 0 0,1 12,13.25A2.25,2.25 0 0,1 9.75,11A2.25,2.25 0 0,1 12,8.75Z" />
                        </svg>
                        <span>Shop</span>
                    </a>
                   <a style="text-decoration: none;" href="{% url 'update-data' %}" class="nav-item" data-tab="data">
    <svg viewBox="0 0 24 24">
        <path fill="currentColor"
            d="M2,21H22V19H2V21M6,17H18V15H6V17M10,13H14V11H10V13M4,9H20V7H4V9Z" />
    </svg>
    <span>Data</span>
</a>

                    <!-- <a style="text-decoration: none;" href="product-detailproduct.slug" class="nav-item" data-tab="crypto">
                        <svg viewBox="0 0 24 24">
                            <path fill="currentColor"
                                d="M17,16H15V8H17M13,16H11V8H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z" />
                        </svg>
                        <span>Crypto</span>
                    </a> -->
                    <a style="text-decoration: none;" href="{% url 'trade' %}" class="nav-item" data-tab="trade">
                        <svg viewBox="0 0 24 24">
                            <path fill="currentColor"
                                d="M21,9V11H18V9H21M16,9V11H13V9H16M12,9V11H9V9H12M8,9V11H5V9H8M22,5V7H2V5H22M13,14H11V17H8V19H11V22H13V19H16V17H13V14Z" />
                        </svg>
                        <span>Trade</span>
                    </a>
                    <a style="text-decoration: none;" href="{% url 'terms' %}" class="nav-item" data-tab="terms">
                        <svg viewBox="0 0 24 24">
                            <path fill="currentColor"
                                d="M14,10H10V12H14V10M14,14H10V16H14V14M14,6H10V8H14V6M20,2H4A2,2 0 0,0 2,4V22L6,18H20A2,2 0 0,0 22,16V4A2,2 0 0,0 20,2Z" />
                        </svg>
                        <span>Terms&P</span>
                    </a>
                </nav>
            </div>
        
        </div> 
    <script>
  const sliderPositions = {};
  const categoryIntervals = {};
  const isManualSliding = {};
  const touchStartX = {};

  function slideCategory(category) {
    const slider = document.querySelector(`.${category}-slider`);
    if (!slider) return;

    const items = slider.querySelectorAll('.product');
    const totalItems = items.length;
    const visibleItems = 4;
    const stepPercent = 25 + 3.75;

    if (totalItems <= visibleItems) return;

    sliderPositions[category] = (sliderPositions[category] || 0) + 1;
    if (sliderPositions[category] > totalItems - visibleItems) {
      sliderPositions[category] = 0;
    }

    slider.style.transform = `translateX(-${sliderPositions[category] * stepPercent}%)`;
  }

  function startAutoSliding(categories) {
    categories.forEach(category => {
      categoryIntervals[category] = setInterval(() => {
        if (!isManualSliding[category]) {
          slideCategory(category);
        }
      }, 3000);
    });
  }

  function initTouchEvents(categories) {
    categories.forEach(category => {
      const slider = document.querySelector(`.${category}-slider`);
      if (!slider) return;

      slider.addEventListener('touchstart', e => {
        touchStartX[category] = e.touches[0].clientX;
        isManualSliding[category] = true;
        clearInterval(categoryIntervals[category]);
      });

      slider.addEventListener('touchmove', e => {
        if (touchStartX[category] == null) return;
        const moveX = e.touches[0].clientX;
        const diffX = touchStartX[category] - moveX;

        const items = slider.querySelectorAll('.product');
        const totalItems = items.length;
        const visibleItems = 4;
        const stepPercent = 25 + 3.75;

        let currentPosition = sliderPositions[category] || 0;
        let newPosition = currentPosition + (diffX > 0 ? 1 : -1);

        newPosition = Math.max(0, Math.min(newPosition, totalItems - visibleItems));
        sliderPositions[category] = newPosition;

        slider.style.transform = `translateX(-${newPosition * stepPercent}%)`;
        touchStartX[category] = moveX;
      });

      slider.addEventListener('touchend', () => {
        isManualSliding[category] = false;
        touchStartX[category] = null;

        categoryIntervals[category] = setInterval(() => {
          if (!isManualSliding[category]) {
            slideCategory(category);
          }
        }, 3000);
      });
    });
  }

  document.addEventListener('DOMContentLoaded', () => {
    const categories = ['games', 'ecommerce', 'esim', 'giftcard'];
    startAutoSliding(categories);
    initTouchEvents(categories);
  });
</script>


{% endblock content %}
        
    